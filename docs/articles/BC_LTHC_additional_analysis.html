<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Additional analysis of BC LTHC outbreak data • cr0eso</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Additional analysis of BC LTHC outbreak data">
<meta property="og:description" content="cr0eso">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cr0eso</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9002</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/BC_LTHC_additional_analysis.html">Additional analysis of BC LTHC outbreak data</a>
    </li>
    <li>
      <a href="../articles/BC_outbreak_data_fitting.html">BC outbreak data fitting</a>
    </li>
    <li>
      <a href="../articles/introduction_to_fitting.html">Introduction to fitting multiple outbreak model</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/sempwn/cr0eso/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="BC_LTHC_additional_analysis_files/header-attrs-2.10/header-attrs.js"></script><script src="BC_LTHC_additional_analysis_files/kePrint-0.0.1/kePrint.js"></script><link href="BC_LTHC_additional_analysis_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Additional analysis of BC LTHC outbreak data</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/sempwn/cr0eso/blob/master/vignettes/BC_LTHC_additional_analysis.Rmd"><code>vignettes/BC_LTHC_additional_analysis.Rmd</code></a></small>
      <div class="hidden name"><code>BC_LTHC_additional_analysis.Rmd</code></div>

    </div>

    
    
<div id="bc-long-term-health-care-outbreak-data" class="section level2">
<h2 class="hasAnchor">
<a href="#bc-long-term-health-care-outbreak-data" class="anchor"></a>BC Long Term Health Care outbreak data</h2>
<p>The data is formatted as a list with 100 imputations of the missing symptom onset times. For each imputation, the list contains data on the number of cases, time series of cases (by symptom onset), the facility capacity and the outbreak reported date for each facility outbreak. It also contains the time series of cases as a matrix, but we will not use that here.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># View the final imputation of missing data:</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">BC_LTHC_outbreaks_100Imputs</span><span class="op">[[</span><span class="fl">100</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; List of 6</span>
<span class="co">#&gt;  $ Location     : int [1:18] 1 2 3 4 5 6 7 8 9 10 ...</span>
<span class="co">#&gt;  $ num_cases    : int [1:18] 67 9 25 18 88 7 5 19 3 44 ...</span>
<span class="co">#&gt;  $ time_series  :List of 18</span>
<span class="co">#&gt;   ..$ : num [1:40] 1 0 0 1 0 0 1 1 0 1 ...</span>
<span class="co">#&gt;   ..$ : num [1:42] 1 0 0 0 2 0 0 1 0 0 ...</span>
<span class="co">#&gt;   ..$ : num [1:47] 1 0 0 0 0 0 0 0 0 1 ...</span>
<span class="co">#&gt;   ..$ : num [1:64] 1 0 0 0 0 0 0 0 0 0 ...</span>
<span class="co">#&gt;   ..$ : num [1:49] 2 0 2 0 0 1 5 4 4 2 ...</span>
<span class="co">#&gt;   ..$ : num [1:17] 2 0 0 0 3 1 0 0 0 0 ...</span>
<span class="co">#&gt;   ..$ : num [1:15] 1 0 0 2 0 0 1 0 0 0 ...</span>
<span class="co">#&gt;   ..$ : num [1:31] 1 0 1 1 1 0 0 2 0 0 ...</span>
<span class="co">#&gt;   ..$ : num [1:5] 2 0 0 0 1</span>
<span class="co">#&gt;   ..$ : num [1:50] 2 0 0 0 0 2 0 0 2 0 ...</span>
<span class="co">#&gt;   ..$ : num [1:40] 1 2 2 1 1 3 2 2 0 1 ...</span>
<span class="co">#&gt;   ..$ : num [1:14] 2 0 1 2 2 1 0 0 0 1 ...</span>
<span class="co">#&gt;   ..$ : num [1:38] 1 0 0 4 1 1 1 4 1 3 ...</span>
<span class="co">#&gt;   ..$ : num [1:25] 1 0 0 0 0 0 0 0 0 1 ...</span>
<span class="co">#&gt;   ..$ : num [1:33] 1 0 0 1 0 0 0 0 2 2 ...</span>
<span class="co">#&gt;   ..$ : num [1:17] 1 0 0 0 0 0 0 0 0 1 ...</span>
<span class="co">#&gt;   ..$ : num [1:50] 2 0 0 0 0 0 0 0 0 2 ...</span>
<span class="co">#&gt;   ..$ : num [1:19] 3 0 0 0 0 2 0 0 0 1 ...</span>
<span class="co">#&gt;  $ capacity     : num [1:18] 139 91 189 120 142 300 87 40 66 236 ...</span>
<span class="co">#&gt;  $ reported_date: Date[1:18], format: "2020-04-28" "2020-04-25" ...</span>
<span class="co">#&gt;  $ case_matrix  : num [1:64, 1:18] 1 0 0 1 0 0 1 1 0 1 ...</span></code></pre></div>
<div id="capacity-by-outbreak-size-plot" class="section level3">
<h3 class="hasAnchor">
<a href="#capacity-by-outbreak-size-plot" class="anchor"></a>Capacity by outbreak size plot</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">plot_data</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span>location<span class="op">=</span><span class="va">BC_LTHC_outbreaks_100Imputs</span><span class="op">[[</span><span class="fl">100</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">Location</span>,  capacity<span class="op">=</span><span class="va">BC_LTHC_outbreaks_100Imputs</span><span class="op">[[</span><span class="fl">100</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">capacity</span>, outbreak_size<span class="op">=</span><span class="va">BC_LTHC_outbreaks_100Imputs</span><span class="op">[[</span><span class="fl">100</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">num_cases</span>, reported_date <span class="op">=</span> <span class="va">BC_LTHC_outbreaks_100Imputs</span><span class="op">[[</span><span class="fl">100</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">reported_date</span><span class="op">)</span>
  
<span class="va">lab_dates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/pretty.html">pretty</a></span><span class="op">(</span><span class="va">plot_data</span><span class="op">$</span><span class="va">reported_date</span><span class="op">)</span>
<span class="co">#&gt; Warning in as.POSIXlt.POSIXct(x): unknown timezone 'GMT'</span>

<span class="va">p</span> <span class="op">&lt;-</span> <span class="va">plot_data</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">capacity</span>,y<span class="op">=</span><span class="va">outbreak_size</span>,color<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">reported_date</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span>size<span class="op">=</span><span class="fl">1.8</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_abline</span><span class="op">(</span>slope<span class="op">=</span><span class="fl">1</span>,intercept<span class="op">=</span><span class="fl">0</span>,linetype<span class="op">=</span><span class="st">"dashed"</span>,alpha<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">coord_cartesian</span><span class="op">(</span>expand<span class="op">=</span><span class="cn">FALSE</span>,xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">305</span><span class="op">)</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">95</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_color_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">lab_dates</span><span class="op">)</span>, 
                       labels <span class="op">=</span> <span class="va">lab_dates</span>,
                       type <span class="op">=</span> <span class="st">"viridis"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>y<span class="op">=</span><span class="st">"Total outbreak size"</span>,x<span class="op">=</span><span class="st">"Maximum capacity"</span>,
       color<span class="op">=</span><span class="st">"Reported date"</span><span class="op">)</span>
<span class="fu">show</span><span class="op">(</span><span class="va">p</span><span class="op">)</span></code></pre></div>
<p><img src="BC_LTHC_additional_analysis_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
</div>
</div>
<div id="cumulative-cases-plot" class="section level2">
<h2 class="hasAnchor">
<a href="#cumulative-cases-plot" class="anchor"></a>Cumulative cases plot</h2>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Relabel locations according to manuscript labelling</span>
<span class="va">fac_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Q"</span>, <span class="st">"I"</span>, <span class="st">"J"</span>, <span class="st">"L"</span>, <span class="st">"O"</span>, <span class="st">"A"</span>, <span class="st">"D"</span>, <span class="st">"N"</span>, <span class="st">"B"</span>, <span class="st">"K"</span>, <span class="st">"R"</span>, <span class="st">"H"</span>, <span class="st">"M"</span>, <span class="st">"C"</span>, <span class="st">"G"</span>, <span class="st">"F"</span>, <span class="st">"P"</span>, <span class="st">"E"</span><span class="op">)</span>

<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">BC_LTHC_outbreaks_100Imputs</span><span class="op">[[</span><span class="fl">100</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">case_matrix</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">fac_names</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span>Day<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>,<span class="va">df</span><span class="op">)</span>

<span class="va">r0_uc_slope</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">3</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="fl">5</span>
<span class="va">r0_lc_slope</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">1.1</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="fl">5</span>

<span class="va">p2</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op">%&gt;%</span> 
  <span class="fu">pivot_longer</span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">value</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">group_by</span><span class="op">(</span><span class="va">name</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">mutate</span><span class="op">(</span>csum <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span>, name<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">name</span>, levels<span class="op">=</span><span class="va">fac_names</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Day</span>, y <span class="op">=</span> <span class="va">csum</span>, group <span class="op">=</span> <span class="va">name</span>, colour <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_line</span><span class="op">(</span>show.legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span> <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">xlab</span><span class="op">(</span><span class="st">"Days since first symptom onset"</span><span class="op">)</span> <span class="op">+</span>  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Cumulative cases"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">scale_y_log10</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_abline</span><span class="op">(</span>slope<span class="op">=</span><span class="va">r0_lc_slope</span>,intercept<span class="op">=</span><span class="fl">0</span>,linetype<span class="op">=</span><span class="st">"dashed"</span>, col<span class="op">=</span><span class="st">"black"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_abline</span><span class="op">(</span>slope<span class="op">=</span><span class="va">r0_uc_slope</span>,intercept<span class="op">=</span><span class="fl">0</span>,linetype<span class="op">=</span><span class="st">"dashed"</span>, col<span class="op">=</span><span class="st">"black"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_dl</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>label <span class="op">=</span> <span class="va">name</span><span class="op">)</span>, method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu">dl.combine</span><span class="op">(</span><span class="st">"last.points"</span><span class="op">)</span>, cex <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">annotate</span><span class="op">(</span>
    <span class="st">"text"</span>,
    x <span class="op">=</span> <span class="fl">5</span>,
    y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="fl">5</span> <span class="op">*</span> <span class="va">r0_uc_slope</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>,
    angle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">atan</a></span><span class="op">(</span><span class="va">r0_uc_slope</span> <span class="op">*</span> <span class="fl">10</span><span class="op">)</span> <span class="op">*</span> <span class="fl">180</span><span class="op">/</span><span class="va">pi</span>,
    label <span class="op">=</span> <span class="st">"R0 = 3"</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">annotate</span><span class="op">(</span>
    <span class="st">"text"</span>,
    x <span class="op">=</span> <span class="fl">10</span>,
    y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="fl">10</span> <span class="op">*</span> <span class="va">r0_lc_slope</span> <span class="op">-</span> <span class="fl">0.01</span><span class="op">)</span>,
    angle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">atan</a></span><span class="op">(</span><span class="va">r0_lc_slope</span> <span class="op">*</span> <span class="fl">10</span><span class="op">)</span> <span class="op">*</span> <span class="fl">180</span><span class="op">/</span><span class="va">pi</span>,
    label <span class="op">=</span> <span class="st">"R0 = 1.1"</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">coord_cartesian</span><span class="op">(</span>ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">100</span><span class="op">)</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">70</span><span class="op">)</span>, expand<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>

<span class="fu">show</span><span class="op">(</span><span class="va">p2</span><span class="op">)</span></code></pre></div>
<p><img src="BC_LTHC_additional_analysis_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
</div>
<div id="estimate-r0-in-each-outbreak-using-eg-and-ml-methods" class="section level2">
<h2 class="hasAnchor">
<a href="#estimate-r0-in-each-outbreak-using-eg-and-ml-methods" class="anchor"></a>Estimate R0 in each outbreak, using EG and ML methods</h2>
<p>For each of the 100 imputations, we estimate R0 independently in each facility using exponential growth (EG) and maximum likelihood (ML) methods, with the ‘R0’ library.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nIts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">BC_LTHC_outbreaks_100Imputs</span><span class="op">)</span>
<span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html">vector</a></span><span class="op">(</span>mode <span class="op">=</span> <span class="st">"list"</span>, length <span class="op">=</span> <span class="va">nIts</span><span class="op">)</span>

<span class="kw">for</span> <span class="op">(</span><span class="va">its</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">nIts</span><span class="op">)</span><span class="op">{</span>
<span class="va">mGT</span><span class="op">&lt;-</span><span class="fu">generation.time</span><span class="op">(</span><span class="st">"gamma"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5.2</span>, <span class="fl">1.73</span><span class="op">)</span><span class="op">)</span>
<span class="va">estr0</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">BC_LTHC_outbreaks_100Imputs</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">Location</span><span class="op">)</span> <span class="op">)</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">BC_LTHC_outbreaks_100Imputs</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">Location</span><span class="op">)</span> <span class="op">)</span><span class="op">{</span>
      <span class="va">end</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">BC_LTHC_outbreaks_100Imputs</span><span class="op">[[</span><span class="va">its</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">time_series</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span> <span class="op">-</span> 
        <span class="fu"><a href="https://rdrr.io/r/base/which.min.html">which.max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span><span class="op">(</span><span class="va">BC_LTHC_outbreaks_100Imputs</span><span class="op">[[</span><span class="va">its</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">time_series</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
      <span class="kw">if</span> <span class="op">(</span><span class="va">end</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span><span class="op">{</span><span class="va">end</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">BC_LTHC_outbreaks_100Imputs</span><span class="op">[[</span><span class="va">its</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">time_series</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">}</span>
      <span class="va">t</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://rdrr.io/r/base/try.html">try</a></span><span class="op">(</span><span class="fu">estimate.R</span><span class="op">(</span>epid <span class="op">=</span> <span class="va">BC_LTHC_outbreaks_100Imputs</span><span class="op">[[</span><span class="va">its</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">time_series</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>,
                          GT <span class="op">=</span> <span class="va">mGT</span>, time.step <span class="op">=</span> <span class="fl">1</span>, 
                          pop.size <span class="op">=</span> <span class="va">BC_LTHC_outbreaks_100Imputs</span><span class="op">[[</span><span class="va">its</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">capacity</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,
                          begin <span class="op">=</span> <span class="fl">1</span>, end <span class="op">=</span> <span class="va">end</span>,
                          methods<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"EG"</span>, <span class="st">"ML"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
      <span class="kw">if</span><span class="op">(</span><span class="st">"try-error"</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span><span class="op">)</span><span class="op">{</span><span class="va">estr0</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">estimate.R</span><span class="op">(</span>epid <span class="op">=</span> 
                              <span class="va">BC_LTHC_outbreaks_100Imputs</span><span class="op">[[</span><span class="va">its</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">time_series</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, 
                              GT <span class="op">=</span> <span class="va">mGT</span>, time.step <span class="op">=</span> <span class="fl">1</span>, pop.size <span class="op">=</span>
                              <span class="va">BC_LTHC_outbreaks_100Imputs</span><span class="op">[[</span><span class="va">its</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">capacity</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,
                              begin <span class="op">=</span> <span class="fl">1</span>, end <span class="op">=</span> <span class="va">end</span>,methods<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"EG"</span><span class="op">)</span><span class="op">)</span><span class="op">}</span><span class="kw">else</span><span class="op">{</span>
                              <span class="va">estr0</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">estimate.R</span><span class="op">(</span>epid <span class="op">=</span> 
                              <span class="va">BC_LTHC_outbreaks_100Imputs</span><span class="op">[[</span><span class="va">its</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">time_series</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, 
                              GT <span class="op">=</span> <span class="va">mGT</span>, time.step <span class="op">=</span> <span class="fl">1</span>, begin <span class="op">=</span> <span class="fl">1</span>, end <span class="op">=</span> <span class="va">end</span>, pop.size <span class="op">=</span>
                              <span class="va">BC_LTHC_outbreaks_100Imputs</span><span class="op">[[</span><span class="va">its</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">capacity</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,
                              methods<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"EG"</span>, <span class="st">"ML"</span><span class="op">)</span><span class="op">)</span><span class="op">}</span>
<span class="op">}</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">estr0</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Facility"</span>, <span class="va">BC_LTHC_outbreaks_100Imputs</span><span class="op">[[</span><span class="va">its</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">Location</span>, sep<span class="op">=</span><span class="st">"_"</span><span class="op">)</span>
<span class="va">res</span><span class="op">[[</span><span class="va">its</span><span class="op">]</span><span class="op">]</span><span class="op">&lt;-</span><span class="va">estr0</span>
<span class="op">}</span></code></pre></div>
</div>
<div id="output-files-and-summary" class="section level2">
<h2 class="hasAnchor">
<a href="#output-files-and-summary" class="anchor"></a>Output files and summary</h2>
<p>We collect summaries of the R0 estimates from a single imputation (the final one), and also calculate confidence intervals across all 100 imputations as a sensitivity analysis.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># First, save the complete nIts=100 sets of estimates to file (the sensitivity analysis) </span>
<span class="co"># We want the mean of the 100 means, and the CI of those 100 means, per outbreak</span>
<span class="va">er_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Location<span class="op">=</span><span class="va">fac_names</span>,
                    EG_mean<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">estr0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
                    EG_mean_CI_lower<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">estr0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
                    EG_mean_CI_upper<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">estr0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
                    ML_mean<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">estr0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
                    ML_mean_CI_lower<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">estr0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
                    ML_mean_CI_upper<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">estr0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span>


<span class="co"># To calculate the confidence intervals on the means</span>
<span class="va">normConfInt</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">alpha</span> <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span><span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">qt</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">alpha</span> <span class="op">/</span> <span class="fl">2</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">}</span>

<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">estr0</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
  <span class="va">a</span><span class="op">&lt;-</span><span class="cn">NULL</span>; <span class="va">b</span><span class="op">&lt;-</span><span class="cn">NULL</span>;
  <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">nIts</span><span class="op">)</span><span class="op">{</span>
  <span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">res</span><span class="op">[[</span><span class="va">j</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">estimates</span><span class="op">$</span><span class="va">EG</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>
  <span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">b</span>, <span class="va">res</span><span class="op">[[</span><span class="va">j</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">estimates</span><span class="op">$</span><span class="va">ML</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>
  <span class="op">}</span>
  <span class="va">er_df</span><span class="op">[</span><span class="va">i</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span><span class="op">)</span>
  <span class="va">er_df</span><span class="op">[</span><span class="va">i</span>, <span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">normConfInt</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>
  <span class="va">er_df</span><span class="op">[</span><span class="va">i</span>, <span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">normConfInt</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>
  <span class="va">er_df</span><span class="op">[</span><span class="va">i</span>, <span class="fl">5</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">b</span><span class="op">)</span><span class="op">)</span>
  <span class="va">er_df</span><span class="op">[</span><span class="va">i</span>, <span class="fl">6</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">normConfInt</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">b</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>
  <span class="va">er_df</span><span class="op">[</span><span class="va">i</span>, <span class="fl">7</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">normConfInt</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">b</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>
<span class="op">}</span>
<span class="va">er_df</span> <span class="op">&lt;-</span> <span class="fu">arrange</span><span class="op">(</span><span class="va">er_df</span>, <span class="va">Location</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/write.table.html">write.table</a></span><span class="op">(</span><span class="va">er_df</span>, file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">outdir</span>,<span class="st">"/R0estimation_results_multiple.txt"</span><span class="op">)</span><span class="op">)</span>

<span class="co"># show table of results</span>
<span class="va">er_df</span> <span class="op">%&gt;%</span>
  <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span><span class="op">(</span>bootstrap_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"striped"</span>,<span class="st">"responsive"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<table class="table table table-striped table-responsive">
<thead><tr>
<th style="text-align:left;">
Location
</th>
<th style="text-align:right;">
EG_mean
</th>
<th style="text-align:right;">
EG_mean_CI_lower
</th>
<th style="text-align:right;">
EG_mean_CI_upper
</th>
<th style="text-align:right;">
ML_mean
</th>
<th style="text-align:right;">
ML_mean_CI_lower
</th>
<th style="text-align:right;">
ML_mean_CI_upper
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
10.6269093
</td>
<td style="text-align:right;">
-8.8532114
</td>
<td style="text-align:right;">
30.1070300
</td>
<td style="text-align:right;">
5.460201
</td>
<td style="text-align:right;">
-1.0344121
</td>
<td style="text-align:right;">
11.954814
</td>
</tr>
<tr>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
0.1085062
</td>
<td style="text-align:right;">
0.1085062
</td>
<td style="text-align:right;">
0.1085062
</td>
<td style="text-align:right;">
1.324182
</td>
<td style="text-align:right;">
1.3241818
</td>
<td style="text-align:right;">
1.324182
</td>
</tr>
<tr>
<td style="text-align:left;">
C
</td>
<td style="text-align:right;">
1.1573214
</td>
<td style="text-align:right;">
1.1573214
</td>
<td style="text-align:right;">
1.1573214
</td>
<td style="text-align:right;">
1.088969
</td>
<td style="text-align:right;">
1.0889689
</td>
<td style="text-align:right;">
1.088969
</td>
</tr>
<tr>
<td style="text-align:left;">
D
</td>
<td style="text-align:right;">
8.5813549
</td>
<td style="text-align:right;">
8.5813549
</td>
<td style="text-align:right;">
8.5813549
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
NaN
</td>
</tr>
<tr>
<td style="text-align:left;">
E
</td>
<td style="text-align:right;">
6.6482600
</td>
<td style="text-align:right;">
-6.4343068
</td>
<td style="text-align:right;">
19.7308269
</td>
<td style="text-align:right;">
3.191398
</td>
<td style="text-align:right;">
-0.4845208
</td>
<td style="text-align:right;">
6.867317
</td>
</tr>
<tr>
<td style="text-align:left;">
F
</td>
<td style="text-align:right;">
2.6483619
</td>
<td style="text-align:right;">
2.6483619
</td>
<td style="text-align:right;">
2.6483619
</td>
<td style="text-align:right;">
2.481302
</td>
<td style="text-align:right;">
2.4813016
</td>
<td style="text-align:right;">
2.481302
</td>
</tr>
<tr>
<td style="text-align:left;">
G
</td>
<td style="text-align:right;">
3.2251127
</td>
<td style="text-align:right;">
3.2251127
</td>
<td style="text-align:right;">
3.2251127
</td>
<td style="text-align:right;">
2.815736
</td>
<td style="text-align:right;">
2.8157357
</td>
<td style="text-align:right;">
2.815736
</td>
</tr>
<tr>
<td style="text-align:left;">
H
</td>
<td style="text-align:right;">
0.9976363
</td>
<td style="text-align:right;">
-0.8485777
</td>
<td style="text-align:right;">
2.8438503
</td>
<td style="text-align:right;">
1.869587
</td>
<td style="text-align:right;">
-2.2292049
</td>
<td style="text-align:right;">
5.968380
</td>
</tr>
<tr>
<td style="text-align:left;">
I
</td>
<td style="text-align:right;">
0.9221586
</td>
<td style="text-align:right;">
0.9221586
</td>
<td style="text-align:right;">
0.9221586
</td>
<td style="text-align:right;">
1.210450
</td>
<td style="text-align:right;">
1.2104496
</td>
<td style="text-align:right;">
1.210450
</td>
</tr>
<tr>
<td style="text-align:left;">
J
</td>
<td style="text-align:right;">
1.2938316
</td>
<td style="text-align:right;">
1.2938316
</td>
<td style="text-align:right;">
1.2938316
</td>
<td style="text-align:right;">
1.195217
</td>
<td style="text-align:right;">
1.1952168
</td>
<td style="text-align:right;">
1.195217
</td>
</tr>
<tr>
<td style="text-align:left;">
K
</td>
<td style="text-align:right;">
2.3304750
</td>
<td style="text-align:right;">
-0.0707417
</td>
<td style="text-align:right;">
4.7316916
</td>
<td style="text-align:right;">
2.022159
</td>
<td style="text-align:right;">
0.5724734
</td>
<td style="text-align:right;">
3.471845
</td>
</tr>
<tr>
<td style="text-align:left;">
L
</td>
<td style="text-align:right;">
1.4039891
</td>
<td style="text-align:right;">
1.4039891
</td>
<td style="text-align:right;">
1.4039891
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
NaN
</td>
</tr>
<tr>
<td style="text-align:left;">
M
</td>
<td style="text-align:right;">
18.7880835
</td>
<td style="text-align:right;">
-59.6174627
</td>
<td style="text-align:right;">
97.1936297
</td>
<td style="text-align:right;">
2.424265
</td>
<td style="text-align:right;">
-2.5489625
</td>
<td style="text-align:right;">
7.397493
</td>
</tr>
<tr>
<td style="text-align:left;">
N
</td>
<td style="text-align:right;">
1.1345167
</td>
<td style="text-align:right;">
1.1345167
</td>
<td style="text-align:right;">
1.1345167
</td>
<td style="text-align:right;">
1.295400
</td>
<td style="text-align:right;">
1.2953995
</td>
<td style="text-align:right;">
1.295400
</td>
</tr>
<tr>
<td style="text-align:left;">
O
</td>
<td style="text-align:right;">
1.7321747
</td>
<td style="text-align:right;">
-3.5101976
</td>
<td style="text-align:right;">
6.9745471
</td>
<td style="text-align:right;">
1.590057
</td>
<td style="text-align:right;">
-0.6351134
</td>
<td style="text-align:right;">
3.815227
</td>
</tr>
<tr>
<td style="text-align:left;">
P
</td>
<td style="text-align:right;">
4.9837638
</td>
<td style="text-align:right;">
3.2858072
</td>
<td style="text-align:right;">
6.6817205
</td>
<td style="text-align:right;">
5.343308
</td>
<td style="text-align:right;">
3.4197483
</td>
<td style="text-align:right;">
7.266867
</td>
</tr>
<tr>
<td style="text-align:left;">
Q
</td>
<td style="text-align:right;">
5.2011965
</td>
<td style="text-align:right;">
3.0231006
</td>
<td style="text-align:right;">
7.3792923
</td>
<td style="text-align:right;">
4.917799
</td>
<td style="text-align:right;">
3.6901495
</td>
<td style="text-align:right;">
6.145448
</td>
</tr>
<tr>
<td style="text-align:left;">
R
</td>
<td style="text-align:right;">
1.7401226
</td>
<td style="text-align:right;">
1.7401226
</td>
<td style="text-align:right;">
1.7401226
</td>
<td style="text-align:right;">
1.962847
</td>
<td style="text-align:right;">
1.9628467
</td>
<td style="text-align:right;">
1.962847
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># Secondly, the final imputation as the primary result</span>
<span class="va">er_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Location<span class="op">=</span><span class="va">fac_names</span>,
                 EG<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">estr0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
                 EG_CI_lower<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">estr0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
                 EG_CI_upper<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">estr0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
                 ML<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">estr0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
                 ML_CI_lower<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">estr0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
                 ML_CI_upper<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">estr0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span>

<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">estr0</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
  <span class="va">er_df</span><span class="op">[</span><span class="va">i</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">estr0</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">estimates</span><span class="op">$</span><span class="va">EG</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>
  <span class="va">er_df</span><span class="op">[</span><span class="va">i</span>, <span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">estr0</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">estimates</span><span class="op">$</span><span class="va">EG</span><span class="op">$</span><span class="va">conf.int</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>
  <span class="va">er_df</span><span class="op">[</span><span class="va">i</span>, <span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">estr0</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">estimates</span><span class="op">$</span><span class="va">EG</span><span class="op">$</span><span class="va">conf.int</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>
  <span class="va">er_df</span><span class="op">[</span><span class="va">i</span>, <span class="fl">5</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">estr0</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">estimates</span><span class="op">$</span><span class="va">ML</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,<span class="cn">NA</span>,<span class="va">estr0</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">estimates</span><span class="op">$</span><span class="va">ML</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>
  <span class="va">er_df</span><span class="op">[</span><span class="va">i</span>, <span class="fl">6</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">estr0</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">estimates</span><span class="op">$</span><span class="va">ML</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,<span class="cn">NA</span>,<span class="va">estr0</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">estimates</span><span class="op">$</span><span class="va">ML</span><span class="op">$</span><span class="va">conf.int</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>
  <span class="va">er_df</span><span class="op">[</span><span class="va">i</span>, <span class="fl">7</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">estr0</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">estimates</span><span class="op">$</span><span class="va">ML</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,<span class="cn">NA</span>,<span class="va">estr0</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">estimates</span><span class="op">$</span><span class="va">ML</span><span class="op">$</span><span class="va">conf.int</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>
<span class="op">}</span>
<span class="va">er_df</span> <span class="op">&lt;-</span> <span class="fu">arrange</span><span class="op">(</span><span class="va">er_df</span>, <span class="va">Location</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/write.table.html">write.table</a></span><span class="op">(</span><span class="va">er_df</span>, file<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">outdir</span>,<span class="st">"/R0estimation_results_single.txt"</span><span class="op">)</span> <span class="op">)</span>

<span class="co"># show table of results</span>
<span class="va">er_df</span> <span class="op">%&gt;%</span>
  <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span><span class="op">(</span>bootstrap_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"striped"</span>,<span class="st">"responsive"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<table class="table table table-striped table-responsive">
<thead><tr>
<th style="text-align:left;">
Location
</th>
<th style="text-align:right;">
EG
</th>
<th style="text-align:right;">
EG_CI_lower
</th>
<th style="text-align:right;">
EG_CI_upper
</th>
<th style="text-align:right;">
ML
</th>
<th style="text-align:right;">
ML_CI_lower
</th>
<th style="text-align:right;">
ML_CI_upper
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
3.0019605
</td>
<td style="text-align:right;">
0.0634776
</td>
<td style="text-align:right;">
64.353581
</td>
<td style="text-align:right;">
3.972551
</td>
<td style="text-align:right;">
0.4554797
</td>
<td style="text-align:right;">
14.088511
</td>
</tr>
<tr>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
0.1085062
</td>
<td style="text-align:right;">
0.0000032
</td>
<td style="text-align:right;">
10.860645
</td>
<td style="text-align:right;">
1.324182
</td>
<td style="text-align:right;">
0.0105389
</td>
<td style="text-align:right;">
8.939934
</td>
</tr>
<tr>
<td style="text-align:left;">
C
</td>
<td style="text-align:right;">
1.1573214
</td>
<td style="text-align:right;">
0.6032579
</td>
<td style="text-align:right;">
2.213223
</td>
<td style="text-align:right;">
1.088969
</td>
<td style="text-align:right;">
0.2293632
</td>
<td style="text-align:right;">
3.045568
</td>
</tr>
<tr>
<td style="text-align:left;">
D
</td>
<td style="text-align:right;">
8.5813549
</td>
<td style="text-align:right;">
0.0134894
</td>
<td style="text-align:right;">
958.227126
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
E
</td>
<td style="text-align:right;">
0.5181015
</td>
<td style="text-align:right;">
0.1915469
</td>
<td style="text-align:right;">
1.125294
</td>
<td style="text-align:right;">
0.720507
</td>
<td style="text-align:right;">
0.1517629
</td>
<td style="text-align:right;">
2.015055
</td>
</tr>
<tr>
<td style="text-align:left;">
F
</td>
<td style="text-align:right;">
2.6483619
</td>
<td style="text-align:right;">
0.8002503
</td>
<td style="text-align:right;">
10.352171
</td>
<td style="text-align:right;">
2.481302
</td>
<td style="text-align:right;">
0.4125962
</td>
<td style="text-align:right;">
7.661795
</td>
</tr>
<tr>
<td style="text-align:left;">
G
</td>
<td style="text-align:right;">
3.2251127
</td>
<td style="text-align:right;">
0.6506007
</td>
<td style="text-align:right;">
16.932821
</td>
<td style="text-align:right;">
2.815736
</td>
<td style="text-align:right;">
0.5930789
</td>
<td style="text-align:right;">
7.875017
</td>
</tr>
<tr>
<td style="text-align:left;">
H
</td>
<td style="text-align:right;">
0.7188200
</td>
<td style="text-align:right;">
0.2881224
</td>
<td style="text-align:right;">
1.598253
</td>
<td style="text-align:right;">
1.202215
</td>
<td style="text-align:right;">
0.4311160
</td>
<td style="text-align:right;">
2.583873
</td>
</tr>
<tr>
<td style="text-align:left;">
I
</td>
<td style="text-align:right;">
0.9221586
</td>
<td style="text-align:right;">
0.5117499
</td>
<td style="text-align:right;">
1.582353
</td>
<td style="text-align:right;">
1.210450
</td>
<td style="text-align:right;">
0.3010219
</td>
<td style="text-align:right;">
3.138771
</td>
</tr>
<tr>
<td style="text-align:left;">
J
</td>
<td style="text-align:right;">
1.2938316
</td>
<td style="text-align:right;">
0.9845823
</td>
<td style="text-align:right;">
1.724130
</td>
<td style="text-align:right;">
1.195217
</td>
<td style="text-align:right;">
0.5743125
</td>
<td style="text-align:right;">
2.154633
</td>
</tr>
<tr>
<td style="text-align:left;">
K
</td>
<td style="text-align:right;">
1.3991400
</td>
<td style="text-align:right;">
1.0340789
</td>
<td style="text-align:right;">
1.910533
</td>
<td style="text-align:right;">
1.378132
</td>
<td style="text-align:right;">
0.7674802
</td>
<td style="text-align:right;">
2.249427
</td>
</tr>
<tr>
<td style="text-align:left;">
L
</td>
<td style="text-align:right;">
1.4039891
</td>
<td style="text-align:right;">
1.0733626
</td>
<td style="text-align:right;">
1.898347
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
M
</td>
<td style="text-align:right;">
1.0422230
</td>
<td style="text-align:right;">
0.6580577
</td>
<td style="text-align:right;">
1.622863
</td>
<td style="text-align:right;">
1.321332
</td>
<td style="text-align:right;">
0.6861250
</td>
<td style="text-align:right;">
2.263093
</td>
</tr>
<tr>
<td style="text-align:left;">
N
</td>
<td style="text-align:right;">
1.1345167
</td>
<td style="text-align:right;">
0.8169595
</td>
<td style="text-align:right;">
1.576101
</td>
<td style="text-align:right;">
1.295400
</td>
<td style="text-align:right;">
0.6077655
</td>
<td style="text-align:right;">
2.371460
</td>
</tr>
<tr>
<td style="text-align:left;">
O
</td>
<td style="text-align:right;">
1.2304994
</td>
<td style="text-align:right;">
1.0090784
</td>
<td style="text-align:right;">
1.502667
</td>
<td style="text-align:right;">
1.338631
</td>
<td style="text-align:right;">
0.9118601
</td>
<td style="text-align:right;">
1.881481
</td>
</tr>
<tr>
<td style="text-align:left;">
P
</td>
<td style="text-align:right;">
4.7932071
</td>
<td style="text-align:right;">
2.8437951
</td>
<td style="text-align:right;">
8.641037
</td>
<td style="text-align:right;">
5.103303
</td>
<td style="text-align:right;">
2.9367991
</td>
<td style="text-align:right;">
8.138745
</td>
</tr>
<tr>
<td style="text-align:left;">
Q
</td>
<td style="text-align:right;">
4.7467273
</td>
<td style="text-align:right;">
3.0491734
</td>
<td style="text-align:right;">
7.749353
</td>
<td style="text-align:right;">
5.183023
</td>
<td style="text-align:right;">
3.3077990
</td>
<td style="text-align:right;">
7.660501
</td>
</tr>
<tr>
<td style="text-align:left;">
R
</td>
<td style="text-align:right;">
1.7401226
</td>
<td style="text-align:right;">
1.3305197
</td>
<td style="text-align:right;">
2.296654
</td>
<td style="text-align:right;">
1.962847
</td>
<td style="text-align:right;">
1.3124932
</td>
<td style="text-align:right;">
2.799088
</td>
</tr>
</tbody>
</table>
</div>
<div id="quick-results-visualisation" class="section level2">
<h2 class="hasAnchor">
<a href="#quick-results-visualisation" class="anchor"></a>Quick results visualisation</h2>
<p>Some simple plots of the results.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">er_df</span><span class="op">$</span><span class="va">EG</span>, breaks<span class="op">=</span><span class="fl">20</span>, main<span class="op">=</span><span class="st">"EG R0 estimates"</span>, xlab<span class="op">=</span><span class="st">"R0"</span>, col<span class="op">=</span><span class="st">"steelblue4"</span><span class="op">)</span></code></pre></div>
<p><img src="BC_LTHC_additional_analysis_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">er_df</span><span class="op">$</span><span class="va">ML</span>, breaks<span class="op">=</span><span class="fl">20</span>, main<span class="op">=</span><span class="st">"ML R0 estimates"</span>, xlab<span class="op">=</span><span class="st">"R0"</span>, col<span class="op">=</span><span class="st">"steelblue4"</span><span class="op">)</span></code></pre></div>
<p><img src="BC_LTHC_additional_analysis_files/figure-html/unnamed-chunk-6-2.png" width="700"></p>
</div>
<div id="attack-rates" class="section level2">
<h2 class="hasAnchor">
<a href="#attack-rates" class="anchor"></a>Attack rates</h2>
<p>We calculate the attack rate in each outbreak as the number of cases divided by the facility capacity. We incorporate uncertainty in the attack rate by varying the denominator from 85% to 115% of the known capacity. R0 is also estimated from the attack rate, according to the relation -log(1-A_r)/A_r = R0.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">AR_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="st">"Facility"</span> <span class="op">=</span> <span class="va">fac_names</span>,  
                  <span class="st">"No. cases"</span> <span class="op">=</span> <span class="va">BC_LTHC_outbreaks_100Imputs</span><span class="op">[[</span><span class="fl">100</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">num_cases</span>,
                  <span class="st">"Capacity"</span> <span class="op">=</span> <span class="va">BC_LTHC_outbreaks_100Imputs</span><span class="op">[[</span><span class="fl">100</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">capacity</span>,
                  <span class="st">"A_r"</span> <span class="op">=</span> 
                    <span class="fl">100</span><span class="op">*</span><span class="va">BC_LTHC_outbreaks_100Imputs</span><span class="op">[[</span><span class="fl">100</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">num_cases</span><span class="op">/</span><span class="va">BC_LTHC_outbreaks_100Imputs</span><span class="op">[[</span><span class="fl">100</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">capacity</span>,
                  <span class="st">"A_r (85% cap.)"</span> <span class="op">=</span>
                    <span class="fl">100</span><span class="op">*</span><span class="va">BC_LTHC_outbreaks_100Imputs</span><span class="op">[[</span><span class="fl">100</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">num_cases</span><span class="op">/</span><span class="op">(</span><span class="va">BC_LTHC_outbreaks_100Imputs</span><span class="op">[[</span><span class="fl">100</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">capacity</span><span class="op">*</span><span class="fl">0.85</span><span class="op">)</span>,
                  <span class="st">"A_r (115% cap.)"</span> <span class="op">=</span>
                    <span class="fl">100</span><span class="op">*</span><span class="va">BC_LTHC_outbreaks_100Imputs</span><span class="op">[[</span><span class="fl">100</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">num_cases</span><span class="op">/</span><span class="op">(</span><span class="va">BC_LTHC_outbreaks_100Imputs</span><span class="op">[[</span><span class="fl">100</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">capacity</span><span class="op">*</span><span class="fl">1.15</span><span class="op">)</span>,
                  <span class="st">"R0 (A_r)"</span> <span class="op">=</span>
                    <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="op">(</span><span class="va">BC_LTHC_outbreaks_100Imputs</span><span class="op">[[</span><span class="fl">100</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">num_cases</span><span class="op">/</span><span class="va">BC_LTHC_outbreaks_100Imputs</span><span class="op">[[</span><span class="fl">100</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">capacity</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="va">BC_LTHC_outbreaks_100Imputs</span><span class="op">[[</span><span class="fl">100</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">num_cases</span><span class="op">/</span><span class="va">BC_LTHC_outbreaks_100Imputs</span><span class="op">[[</span><span class="fl">100</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">capacity</span><span class="op">)</span>,
                  <span class="st">"R0 (A_r, 85% cap.)"</span> <span class="op">=</span>
                    <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="op">(</span><span class="va">BC_LTHC_outbreaks_100Imputs</span><span class="op">[[</span><span class="fl">100</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">num_cases</span><span class="op">/</span><span class="va">BC_LTHC_outbreaks_100Imputs</span><span class="op">[[</span><span class="fl">100</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">capacity</span><span class="op">*</span><span class="fl">0.85</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="va">BC_LTHC_outbreaks_100Imputs</span><span class="op">[[</span><span class="fl">100</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">num_cases</span><span class="op">/</span><span class="va">BC_LTHC_outbreaks_100Imputs</span><span class="op">[[</span><span class="fl">100</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">capacity</span><span class="op">*</span><span class="fl">0.85</span><span class="op">)</span>,
                  <span class="st">"R0 (A_r, 115% cap.)"</span> <span class="op">=</span>
                    <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="op">(</span><span class="va">BC_LTHC_outbreaks_100Imputs</span><span class="op">[[</span><span class="fl">100</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">num_cases</span><span class="op">/</span><span class="va">BC_LTHC_outbreaks_100Imputs</span><span class="op">[[</span><span class="fl">100</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">capacity</span><span class="op">*</span><span class="fl">1.15</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="va">BC_LTHC_outbreaks_100Imputs</span><span class="op">[[</span><span class="fl">100</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">num_cases</span><span class="op">/</span><span class="va">BC_LTHC_outbreaks_100Imputs</span><span class="op">[[</span><span class="fl">100</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">capacity</span><span class="op">*</span><span class="fl">1.15</span><span class="op">)</span> <span class="op">)</span>
<span class="va">AR_table</span> <span class="op">&lt;-</span> <span class="fu">arrange</span><span class="op">(</span><span class="va">AR_table</span>, <span class="va">Facility</span><span class="op">)</span>

<span class="co"># show table of results</span>
<span class="va">AR_table</span> <span class="op">%&gt;%</span>
  <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span><span class="op">(</span>bootstrap_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"striped"</span>,<span class="st">"responsive"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<table class="table table table-striped table-responsive">
<thead><tr>
<th style="text-align:left;">
Facility
</th>
<th style="text-align:right;">
No..cases
</th>
<th style="text-align:right;">
Capacity
</th>
<th style="text-align:right;">
A_r
</th>
<th style="text-align:right;">
A_r..85..cap..
</th>
<th style="text-align:right;">
A_r..115..cap..
</th>
<th style="text-align:right;">
R0..A_r.
</th>
<th style="text-align:right;">
R0..A_r..85..cap..
</th>
<th style="text-align:right;">
R0..A_r..115..cap..
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
300
</td>
<td style="text-align:right;">
2.333333
</td>
<td style="text-align:right;">
2.745098
</td>
<td style="text-align:right;">
2.028986
</td>
<td style="text-align:right;">
1.011851
</td>
<td style="text-align:right;">
1.010050
</td>
<td style="text-align:right;">
1.013662
</td>
</tr>
<tr>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
66
</td>
<td style="text-align:right;">
4.545454
</td>
<td style="text-align:right;">
5.347594
</td>
<td style="text-align:right;">
3.952569
</td>
<td style="text-align:right;">
1.023440
</td>
<td style="text-align:right;">
1.019831
</td>
<td style="text-align:right;">
1.027084
</td>
</tr>
<tr>
<td style="text-align:left;">
C
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
236
</td>
<td style="text-align:right;">
2.542373
</td>
<td style="text-align:right;">
2.991027
</td>
<td style="text-align:right;">
2.210759
</td>
<td style="text-align:right;">
1.012932
</td>
<td style="text-align:right;">
1.010963
</td>
<td style="text-align:right;">
1.014910
</td>
</tr>
<tr>
<td style="text-align:left;">
D
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
87
</td>
<td style="text-align:right;">
5.747126
</td>
<td style="text-align:right;">
6.761325
</td>
<td style="text-align:right;">
4.997501
</td>
<td style="text-align:right;">
1.029886
</td>
<td style="text-align:right;">
1.025251
</td>
<td style="text-align:right;">
1.034578
</td>
</tr>
<tr>
<td style="text-align:left;">
E
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
89
</td>
<td style="text-align:right;">
8.988764
</td>
<td style="text-align:right;">
10.575017
</td>
<td style="text-align:right;">
7.816317
</td>
<td style="text-align:right;">
1.047833
</td>
<td style="text-align:right;">
1.040267
</td>
<td style="text-align:right;">
1.055548
</td>
</tr>
<tr>
<td style="text-align:left;">
F
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
92
</td>
<td style="text-align:right;">
6.521739
</td>
<td style="text-align:right;">
7.672634
</td>
<td style="text-align:right;">
5.671077
</td>
<td style="text-align:right;">
1.034100
</td>
<td style="text-align:right;">
1.028786
</td>
<td style="text-align:right;">
1.039487
</td>
</tr>
<tr>
<td style="text-align:left;">
G
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
210
</td>
<td style="text-align:right;">
6.666667
</td>
<td style="text-align:right;">
7.843137
</td>
<td style="text-align:right;">
5.797101
</td>
<td style="text-align:right;">
1.034893
</td>
<td style="text-align:right;">
1.029451
</td>
<td style="text-align:right;">
1.040413
</td>
</tr>
<tr>
<td style="text-align:left;">
H
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
75
</td>
<td style="text-align:right;">
16.000000
</td>
<td style="text-align:right;">
18.823529
</td>
<td style="text-align:right;">
13.913044
</td>
<td style="text-align:right;">
1.089709
</td>
<td style="text-align:right;">
1.074871
</td>
<td style="text-align:right;">
1.105114
</td>
</tr>
<tr>
<td style="text-align:left;">
I
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
91
</td>
<td style="text-align:right;">
9.890110
</td>
<td style="text-align:right;">
11.635423
</td>
<td style="text-align:right;">
8.600096
</td>
<td style="text-align:right;">
1.052974
</td>
<td style="text-align:right;">
1.044548
</td>
<td style="text-align:right;">
1.061585
</td>
</tr>
<tr>
<td style="text-align:left;">
J
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
189
</td>
<td style="text-align:right;">
13.227513
</td>
<td style="text-align:right;">
15.561780
</td>
<td style="text-align:right;">
11.502185
</td>
<td style="text-align:right;">
1.072617
</td>
<td style="text-align:right;">
1.060821
</td>
<td style="text-align:right;">
1.084774
</td>
</tr>
<tr>
<td style="text-align:left;">
K
</td>
<td style="text-align:right;">
44
</td>
<td style="text-align:right;">
236
</td>
<td style="text-align:right;">
18.644068
</td>
<td style="text-align:right;">
21.934197
</td>
<td style="text-align:right;">
16.212233
</td>
<td style="text-align:right;">
1.106714
</td>
<td style="text-align:right;">
1.088749
</td>
<td style="text-align:right;">
1.125506
</td>
</tr>
<tr>
<td style="text-align:left;">
L
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
120
</td>
<td style="text-align:right;">
15.000000
</td>
<td style="text-align:right;">
17.647059
</td>
<td style="text-align:right;">
13.043478
</td>
<td style="text-align:right;">
1.083460
</td>
<td style="text-align:right;">
1.069746
</td>
<td style="text-align:right;">
1.097659
</td>
</tr>
<tr>
<td style="text-align:left;">
M
</td>
<td style="text-align:right;">
37
</td>
<td style="text-align:right;">
151
</td>
<td style="text-align:right;">
24.503311
</td>
<td style="text-align:right;">
28.827425
</td>
<td style="text-align:right;">
21.307227
</td>
<td style="text-align:right;">
1.147116
</td>
<td style="text-align:right;">
1.121314
</td>
<td style="text-align:right;">
1.174608
</td>
</tr>
<tr>
<td style="text-align:left;">
N
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:right;">
40
</td>
<td style="text-align:right;">
47.500000
</td>
<td style="text-align:right;">
55.882353
</td>
<td style="text-align:right;">
41.304348
</td>
<td style="text-align:right;">
1.356541
</td>
<td style="text-align:right;">
1.280731
</td>
<td style="text-align:right;">
1.446607
</td>
</tr>
<tr>
<td style="text-align:left;">
O
</td>
<td style="text-align:right;">
88
</td>
<td style="text-align:right;">
142
</td>
<td style="text-align:right;">
61.971831
</td>
<td style="text-align:right;">
72.908036
</td>
<td style="text-align:right;">
53.888549
</td>
<td style="text-align:right;">
1.560133
</td>
<td style="text-align:right;">
1.420292
</td>
<td style="text-align:right;">
1.749947
</td>
</tr>
<tr>
<td style="text-align:left;">
P
</td>
<td style="text-align:right;">
89
</td>
<td style="text-align:right;">
154
</td>
<td style="text-align:right;">
57.792208
</td>
<td style="text-align:right;">
67.990833
</td>
<td style="text-align:right;">
50.254094
</td>
<td style="text-align:right;">
1.492529
</td>
<td style="text-align:right;">
1.375652
</td>
<td style="text-align:right;">
1.643764
</td>
</tr>
<tr>
<td style="text-align:left;">
Q
</td>
<td style="text-align:right;">
67
</td>
<td style="text-align:right;">
139
</td>
<td style="text-align:right;">
48.201439
</td>
<td style="text-align:right;">
56.707575
</td>
<td style="text-align:right;">
41.914295
</td>
<td style="text-align:right;">
1.364706
</td>
<td style="text-align:right;">
1.286623
</td>
<td style="text-align:right;">
1.457915
</td>
</tr>
<tr>
<td style="text-align:left;">
R
</td>
<td style="text-align:right;">
79
</td>
<td style="text-align:right;">
92
</td>
<td style="text-align:right;">
85.869565
</td>
<td style="text-align:right;">
101.023018
</td>
<td style="text-align:right;">
74.669187
</td>
<td style="text-align:right;">
2.278851
</td>
<td style="text-align:right;">
1.793323
</td>
<td style="text-align:right;">
4.437495
</td>
</tr>
</tbody>
</table>
</div>
<div id="compare-attack-rate-to-r0-estimates-from-different-methods" class="section level2">
<h2 class="hasAnchor">
<a href="#compare-attack-rate-to-r0-estimates-from-different-methods" class="anchor"></a>Compare attack rate to R0 estimates from different methods</h2>
<p>Next, compare EG and ML estimates with results from the Bayesian hierarchical model, against the attack rate.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># The Bayesian hierarchical model results are manually set here, so remember to update these if you are adapting this script for another analysis. </span>
<span class="va">BHM</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.56</span>, <span class="fl">0.79</span>, <span class="fl">0.86</span>, <span class="fl">0.93</span>, <span class="fl">1.2</span>, <span class="fl">1.47</span>, <span class="fl">1.52</span>, <span class="fl">1.57</span>, <span class="fl">2.1</span>, <span class="fl">2.9</span>, <span class="fl">3.2</span>, <span class="fl">3.27</span>, <span class="fl">3.32</span>, <span class="fl">4.55</span>, <span class="fl">5.73</span>, <span class="fl">6.09</span>, <span class="fl">8.17</span>, <span class="fl">9.17</span><span class="op">)</span>
<span class="co"># The following aren't used until the next chunk:</span>
<span class="va">BHM_multi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2.6</span>, <span class="fl">2.97</span>, <span class="fl">2.62</span>, <span class="fl">3.28</span>, <span class="fl">3.73</span>, <span class="fl">3.68</span>, <span class="fl">3.62</span>, <span class="fl">5.39</span>, <span class="fl">2.87</span>, <span class="fl">2.71</span>, <span class="fl">3.82</span>, <span class="fl">2.37</span>, <span class="fl">4.73</span>, <span class="fl">6.65</span>, <span class="fl">6.7</span>, <span class="fl">6.91</span>, <span class="fl">9.95</span>, <span class="fl">9.13</span><span class="op">)</span> <span class="co"># multi-level zeta point estimates</span>
<span class="va">BHM_upCI</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1.17</span>, <span class="fl">1.79</span>, <span class="fl">1.54</span>, <span class="fl">1.89</span>, <span class="fl">2.21</span>, <span class="fl">2.5</span>, <span class="fl">2.33</span>, <span class="fl">2.69</span>, <span class="fl">3.23</span>, <span class="fl">3.98</span>, <span class="fl">4.35</span>, <span class="fl">4.51</span>, <span class="fl">4.58</span>, <span class="fl">6.98</span>, <span class="fl">7.76</span>, <span class="fl">8.04</span>, <span class="fl">11.38</span>, <span class="fl">11.97</span><span class="op">)</span> <span class="co"># BHM upper credible interval</span>
<span class="va">BHM_multi_upCI</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4.96</span>, <span class="fl">5.99</span>, <span class="fl">4.87</span>, <span class="fl">6.81</span>, <span class="fl">7.46</span>, <span class="fl">6.9</span>, <span class="fl">6.54</span>, <span class="fl">9.52</span>, <span class="fl">5.14</span>, <span class="fl">4.03</span>, <span class="fl">5.55</span>, <span class="fl">3.43</span>, <span class="fl">7.23</span>, <span class="fl">10.32</span>, <span class="fl">8.9</span>, <span class="fl">9.01</span>, <span class="fl">13.21</span>, <span class="fl">12.35</span><span class="op">)</span> <span class="co"># multi-level zeta upper credible interval</span>
<span class="va">BHM_lowCI</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.16</span>, <span class="fl">0.22</span>, <span class="fl">0.35</span>, <span class="fl">0.3</span>, <span class="fl">0.46</span>, <span class="fl">0.7</span>, <span class="fl">0.91</span>, <span class="fl">0.7</span>, <span class="fl">1.29</span>, <span class="fl">2.13</span>, <span class="fl">2.41</span>, <span class="fl">2.42</span>, <span class="fl">2.43</span>, <span class="fl">3.05</span>, <span class="fl">4.37</span>, <span class="fl">4.7</span>, <span class="fl">5.29</span>, <span class="fl">7.16</span><span class="op">)</span> <span class="co"># BHM lower credible interval</span>
<span class="va">BHM_multi_lowCI</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1.26</span>, <span class="fl">1.38</span>, <span class="fl">1.35</span>, <span class="fl">1.59</span>, <span class="fl">1.7</span>, <span class="fl">1.8</span>, <span class="fl">1.85</span>, <span class="fl">2.45</span>, <span class="fl">1.61</span>, <span class="fl">1.83</span>, <span class="fl">2.67</span>, <span class="fl">1.6</span>, <span class="fl">3.08</span>, <span class="fl">4.1</span>, <span class="fl">5.06</span>, <span class="fl">5.31</span>, <span class="fl">7.44</span>, <span class="fl">7.06</span><span class="op">)</span> <span class="co"># multi-level zeta lower credible interval</span>

<span class="va">scatterdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">AR_table</span><span class="op">$</span><span class="va">Facility</span>,<span class="va">AR_table</span><span class="op">$</span><span class="va">Facility</span>,<span class="va">AR_table</span><span class="op">$</span><span class="va">Facility</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">AR_table</span><span class="op">$</span><span class="va">A_r</span>,<span class="va">AR_table</span><span class="op">$</span><span class="va">A_r</span>,<span class="va">AR_table</span><span class="op">$</span><span class="va">A_r</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">er_df</span><span class="op">$</span><span class="va">EG</span>,<span class="va">er_df</span><span class="op">$</span><span class="va">ML</span>,<span class="va">BHM</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Exponential growth"</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">AR_table</span><span class="op">$</span><span class="va">A_r</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Maximum likelihood"</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">AR_table</span><span class="op">$</span><span class="va">A_r</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Bayesian hierarchical"</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">AR_table</span><span class="op">$</span><span class="va">A_r</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">scatterdata</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Facility"</span>, <span class="st">"ar"</span>, <span class="st">"r0"</span>, <span class="st">"Method"</span><span class="op">)</span>

<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">scatterdata</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">ar</span>, y<span class="op">=</span><span class="va">r0</span>, color<span class="op">=</span><span class="va">Method</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span>size<span class="op">=</span><span class="fl">3</span>, alpha<span class="op">=</span><span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_smooth</span><span class="op">(</span>method<span class="op">=</span><span class="va">lm</span>, se<span class="op">=</span><span class="cn">FALSE</span>, fullrange<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">+</span>
  <span class="co">#theme_sleek() + </span>
  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Attack Rate (%)"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ylab</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">R</span><span class="op">[</span><span class="st">'0,k'</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>  <span class="fu">theme</span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"right"</span>, legend.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size<span class="op">=</span><span class="fl">10</span>,                                           face<span class="op">=</span><span class="st">"bold"</span><span class="op">)</span>, legend.text<span class="op">=</span><span class="fu">element_text</span><span class="op">(</span>size<span class="op">=</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="co">#scale_colour_ggthemr_d() +</span>
  <span class="fu">annotate</span><span class="op">(</span>geom<span class="op">=</span><span class="st">"label"</span>, x<span class="op">=</span><span class="fl">75</span>, y<span class="op">=</span><span class="fl">9.7</span>, label<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">AR_table</span><span class="op">$</span><span class="va">A_r</span>, <span class="va">BHM</span><span class="op">)</span>,<span class="fl">2</span><span class="op">)</span>, colour<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/palette.html">palette</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">annotate</span><span class="op">(</span>geom<span class="op">=</span><span class="st">"label"</span>, x<span class="op">=</span><span class="fl">75</span>, y<span class="op">=</span><span class="fl">1.7</span>, label<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">AR_table</span><span class="op">$</span><span class="va">A_r</span>, <span class="va">er_df</span><span class="op">$</span><span class="va">EG</span><span class="op">)</span>,<span class="fl">2</span><span class="op">)</span>, colour<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/palette.html">palette</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">annotate</span><span class="op">(</span>geom<span class="op">=</span><span class="st">"label"</span>, x<span class="op">=</span><span class="fl">75</span>, y<span class="op">=</span><span class="fl">3.5</span>, label<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">AR_table</span><span class="op">$</span><span class="va">A_r</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">er_df</span><span class="op">$</span><span class="va">ML</span><span class="op">)</span><span class="op">]</span>, <span class="va">er_df</span><span class="op">$</span><span class="va">ML</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">er_df</span><span class="op">$</span><span class="va">ML</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>,<span class="fl">2</span><span class="op">)</span>, colour<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/palette.html">palette</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span> 
<span class="co"># The geom_smooth/geom_point warning messages can be safely ignored - these are caused by the missing ML values</span>
<span class="va">p</span>
<span class="co">#&gt; `geom_smooth()` using formula 'y ~ x'</span>
<span class="co">#&gt; Warning: Removed 2 rows containing non-finite values (stat_smooth).</span>
<span class="co">#&gt; Warning: Removed 2 rows containing missing values (geom_point).</span></code></pre></div>
<p><img src="BC_LTHC_additional_analysis_files/figure-html/unnamed-chunk-8-1.png" width="672"></p>
</div>
<div id="compare-r0-estimates-from-three-main-methods-bhm-eg-ml" class="section level2">
<h2 class="hasAnchor">
<a href="#compare-r0-estimates-from-three-main-methods-bhm-eg-ml" class="anchor"></a>Compare R0 estimates from three main methods (BHM, EG, ML)</h2>
<p>This figure compares point estimates and confidence intervals/credible intervals from the BHM (single- and multi- level zeta), EG and ML methods.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co">## First combine the results into a data frame</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">er_df</span><span class="op">$</span><span class="va">Location</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span>,
                 <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">er_df</span><span class="op">$</span><span class="va">EG</span>, <span class="va">er_df</span><span class="op">$</span><span class="va">ML</span> , <span class="va">BHM</span>, <span class="va">BHM_multi</span><span class="op">)</span><span class="op">)</span>,
                 <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">er_df</span><span class="op">$</span><span class="va">EG_CI_upper</span>, <span class="va">er_df</span><span class="op">$</span><span class="va">ML_CI_upper</span>, <span class="va">BHM_upCI</span>, <span class="va">BHM_multi_upCI</span><span class="op">)</span><span class="op">)</span>,
                 <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">er_df</span><span class="op">$</span><span class="va">EG_CI_lower</span>, <span class="va">er_df</span><span class="op">$</span><span class="va">ML_CI_lower</span>, <span class="va">BHM_lowCI</span>, <span class="va">BHM_multi_lowCI</span><span class="op">)</span><span class="op">)</span>,
                 <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Exponential growth"</span>,
                       <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">er_df</span><span class="op">$</span><span class="va">Location</span><span class="op">)</span><span class="op">)</span>,
                   <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Maximum likelihood"</span>,
                       <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">er_df</span><span class="op">$</span><span class="va">Location</span><span class="op">)</span><span class="op">)</span>,
                   <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Bayesian hierarchical"</span>,
                       <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">er_df</span><span class="op">$</span><span class="va">Location</span><span class="op">)</span><span class="op">)</span>,
                   <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Bayesian hierarchical, multi-level"</span>,
                       <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">er_df</span><span class="op">$</span><span class="va">Location</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Location"</span>, <span class="st">"R0"</span>, <span class="st">"lowerCI"</span>, <span class="st">"upperCI"</span>, <span class="st">"Method"</span><span class="op">)</span>

<span class="va">p</span><span class="op">&lt;-</span><span class="fu">ggplot</span><span class="op">(</span><span class="va">df</span>, <span class="fu">aes</span><span class="op">(</span>y<span class="op">=</span><span class="va">Location</span>, x<span class="op">=</span><span class="va">R0</span>, group<span class="op">=</span><span class="va">Method</span>, color<span class="op">=</span><span class="va">Method</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">xlab</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">R</span><span class="op">[</span><span class="st">'0,k'</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ylab</span><span class="op">(</span><span class="st">"Location"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_errorbarh</span><span class="op">(</span>mapping<span class="op">=</span><span class="fu">aes</span><span class="op">(</span>xmin<span class="op">=</span><span class="va">lowerCI</span>, xmax<span class="op">=</span><span class="va">upperCI</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">0.5</span>, alpha<span class="op">=</span><span class="fl">0.99</span>, position<span class="op">=</span><span class="fu">position_dodgev</span><span class="op">(</span>height<span class="op">=</span><span class="fl">0.8</span><span class="op">)</span>, height<span class="op">=</span><span class="fl">0</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span>position<span class="op">=</span><span class="fu">position_dodgev</span><span class="op">(</span>height<span class="op">=</span><span class="fl">0.8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="co">#theme_sleek() +</span>
  <span class="fu">theme</span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"bottom"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">guides</span><span class="op">(</span>colour <span class="op">=</span> <span class="fu">guide_legend</span><span class="op">(</span>nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">scale_x_continuous</span><span class="op">(</span>trans<span class="op">=</span><span class="st">"log10"</span>, limits<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.000001</span>,<span class="fl">1000</span><span class="op">)</span>, labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"0.001"</span>,<span class="st">"0.01"</span>,<span class="st">"0.1"</span>, <span class="st">"1.0"</span>,<span class="st">"10"</span>,<span class="st">"100"</span>, <span class="st">"1000"</span><span class="op">)</span>, breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.001</span>,<span class="fl">0.01</span>, <span class="fl">0.1</span>, <span class="fl">1</span>, <span class="fl">10</span>, <span class="fl">100</span>, <span class="fl">1000</span><span class="op">)</span><span class="op">)</span>
<span class="va">p</span>
<span class="co">#&gt; Warning: Removed 2 rows containing missing values (geom_errorbarh).</span>
<span class="co">#&gt; Warning: Removed 2 rows containing missing values (geom_point).</span></code></pre></div>
<p><img src="BC_LTHC_additional_analysis_files/figure-html/unnamed-chunk-9-1.png" width="672"></p>
</div>
<div id="correlations-between-r0-estimates-and-additional-lthc-facility-covariate-data" class="section level2">
<h2 class="hasAnchor">
<a href="#correlations-between-r0-estimates-and-additional-lthc-facility-covariate-data" class="anchor"></a>Correlations between R0 estimates and additional LTHC facility covariate data</h2>
<p>In this section we investigate any relationships between the facility R0 estimates and additional data obtained on the LTHC facilities (age of facility, room type etc.). The additional data is primarily contained in <em>italic</em>BC_OSABC_facilitydata.rda<em>italic</em>, and some factors we have loaded already (e.g. outbreak reported date).</p>
<p>First, we take a look at a few of these individually:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># Take a look at the additional factor data:</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">BC_OSABC_facilitydata</span><span class="op">)</span>
<span class="co">#&gt;   Location LTHC facility type Year facility opened Resident room type</span>
<span class="co">#&gt; 1        1         Non-profit                 1974      Mostly single</span>
<span class="co">#&gt; 2        2            Private                 1960             Single</span>
<span class="co">#&gt; 3        3             Public                 1998      Mostly single</span>
<span class="co">#&gt; 4        4               &lt;NA&gt;                   NA               &lt;NA&gt;</span>
<span class="co">#&gt; 5        5         Non-profit                 1947       Mostly multi</span>
<span class="co">#&gt; 6        6         Non-profit                 1989      Mostly single</span>
<span class="co">#&gt;   Accreditation status Direct care hours /resident/day</span>
<span class="co">#&gt; 1           Accredited                            3.36</span>
<span class="co">#&gt; 2           Accredited                            3.36</span>
<span class="co">#&gt; 3           Accredited                            3.50</span>
<span class="co">#&gt; 4                 &lt;NA&gt;                              NA</span>
<span class="co">#&gt; 5           Accredited                            3.60</span>
<span class="co">#&gt; 6           Accredited                            3.03</span>
<span class="co">#&gt;   Average resident age (years) Average resident stay (days)</span>
<span class="co">#&gt; 1                           88                          831</span>
<span class="co">#&gt; 2                           91                         1063</span>
<span class="co">#&gt; 3                           84                         1296</span>
<span class="co">#&gt; 4                           NA                           NA</span>
<span class="co">#&gt; 5                           85                          761</span>
<span class="co">#&gt; 6                           87                          699</span>
<span class="co">#&gt;   Residents dependent for daily activities (%)</span>
<span class="co">#&gt; 1                                         29.8</span>
<span class="co">#&gt; 2                                         27.7</span>
<span class="co">#&gt; 3                                         49.3</span>
<span class="co">#&gt; 4                                           NA</span>
<span class="co">#&gt; 5                                         36.6</span>
<span class="co">#&gt; 6                                         28.8</span>
<span class="co">#&gt;   Number of lodged complaints 2018/19 Number of disease outbreaks 2018/19</span>
<span class="co">#&gt; 1                                   0                                   0</span>
<span class="co">#&gt; 2                                   1                                   0</span>
<span class="co">#&gt; 3                                   0                                   1</span>
<span class="co">#&gt; 4                                  NA                                  NA</span>
<span class="co">#&gt; 5                                   0                                   2</span>
<span class="co">#&gt; 6                                   5                                   0</span>
<span class="co">#&gt;   Identity of initial COVID-19 case</span>
<span class="co">#&gt; 1                      Staff/worker</span>
<span class="co">#&gt; 2                      Staff/worker</span>
<span class="co">#&gt; 3                      Staff/worker</span>
<span class="co">#&gt; 4                      Staff/worker</span>
<span class="co">#&gt; 5                  Resident/patient</span>
<span class="co">#&gt; 6                  Resident/patient</span>
<span class="co"># Re-order to alphabetical labelling</span>
<span class="va">BC_OSABC_facilitydata</span><span class="op">$</span><span class="va">Facility</span> <span class="op">=</span> <span class="va">fac_names</span>
<span class="va">BC_OSABC_facilitydata</span> <span class="op">&lt;-</span> <span class="fu">arrange</span><span class="op">(</span><span class="va">BC_OSABC_facilitydata</span>, <span class="va">Facility</span><span class="op">)</span>

<span class="co"># Was the initial (by symptom onset) case staff?</span>
<span class="co"># (2 outbreaks with multiple earliest symptom onsets, both resident &amp; staff: 9 and 17.</span>
<span class="co"># These are coded as unknown.)</span>
<span class="va">staff_cat</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">BC_OSABC_facilitydata</span><span class="op">$</span><span class="va">`Identity of initial COVID-19 case`</span><span class="op">)</span>

<span class="co"># Remove the 'unknown' categorisations to make this factor dichotomous, and calculate the correlation with R0</span>
<span class="va">staff_cat_di</span> <span class="op">&lt;-</span> <span class="va">staff_cat</span><span class="op">[</span><span class="va">staff_cat</span><span class="op">!=</span><span class="st">"Unknown"</span><span class="op">]</span>
<span class="va">staff_cat_di</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/class.html">unclass</a></span><span class="op">(</span><span class="va">staff_cat_di</span><span class="op">)</span>

<span class="co"># Initial case</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"BHM and identity of initial case correlation = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">staff_cat_di</span>, <span class="va">BHM</span><span class="op">[</span><span class="va">staff_cat</span><span class="op">!=</span><span class="st">"Unknown"</span><span class="op">]</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] "BHM and identity of initial case correlation = 0.152"</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"BHM multi-level and identity of initial case correlation = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">staff_cat_di</span>, <span class="va">BHM_multi</span><span class="op">[</span><span class="va">staff_cat</span><span class="op">!=</span><span class="st">"Unknown"</span><span class="op">]</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] "BHM multi-level and identity of initial case correlation = 0.007"</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"BHM and identity of initial case correlation = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">staff_cat_di</span>, <span class="va">er_df</span><span class="op">$</span><span class="va">EG</span><span class="op">[</span><span class="va">staff_cat</span><span class="op">!=</span><span class="st">"Unknown"</span><span class="op">]</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] "BHM and identity of initial case correlation = -0.246"</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"BHM and identity of initial case correlation = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/class.html">unclass</a></span><span class="op">(</span><span class="va">staff_cat</span><span class="op">[</span><span class="va">staff_cat</span><span class="op">!=</span><span class="st">"Unknown"</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">er_df</span><span class="op">$</span><span class="va">ML</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>, <span class="va">er_df</span><span class="op">$</span><span class="va">ML</span><span class="op">[</span><span class="va">staff_cat</span><span class="op">!=</span><span class="st">"Unknown"</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">er_df</span><span class="op">$</span><span class="va">ML</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="co">#only non-NA ML ests</span>
<span class="co">#&gt; [1] "BHM and identity of initial case correlation = 0.056"</span>


<span class="co"># Facility capacity</span>
<span class="va">fac_cap</span> <span class="op">&lt;-</span> <span class="va">BC_LTHC_outbreaks_100Imputs</span><span class="op">[[</span><span class="fl">100</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">capacity</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">fac_names</span><span class="op">)</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"BHM and facility capacity correlation = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">BHM</span>, <span class="va">fac_cap</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] "BHM and facility capacity correlation = -0.167"</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"BHM multi-level and facility capacity correlation = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">BHM_multi</span>, <span class="va">fac_cap</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] "BHM multi-level and facility capacity correlation = -0.282"</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"EG and facility capacity correlation = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">er_df</span><span class="op">$</span><span class="va">EG</span>, <span class="va">fac_cap</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] "EG and facility capacity correlation = 0.073"</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"ML and facility capacity correlation = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">er_df</span><span class="op">$</span><span class="va">ML</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">er_df</span><span class="op">$</span><span class="va">ML</span><span class="op">)</span><span class="op">]</span>, <span class="va">fac_cap</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">er_df</span><span class="op">$</span><span class="va">ML</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] "ML and facility capacity correlation = 0.295"</span>


<span class="co"># outbreak reported date</span>
<span class="va">rep_date</span> <span class="op">&lt;-</span> <span class="va">BC_LTHC_outbreaks_100Imputs</span><span class="op">[[</span><span class="fl">100</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">reported_date</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">fac_names</span><span class="op">)</span><span class="op">]</span>
<span class="va">rep_date</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html">as.POSIXct</a></span><span class="op">(</span><span class="va">rep_date</span>, format<span class="op">=</span><span class="st">"%Y-%m-%d %H:%M:%S"</span>, tz<span class="op">=</span><span class="st">"GMT"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"BHM and facility capacity correlation = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">BHM</span>, <span class="va">rep_date</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] "BHM and facility capacity correlation = -0.254"</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"BHM multi-level and facility capacity correlation = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">BHM_multi</span>, <span class="va">rep_date</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] "BHM multi-level and facility capacity correlation = -0.09"</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"EG and facility capacity correlation = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">er_df</span><span class="op">$</span><span class="va">EG</span>, <span class="va">rep_date</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] "EG and facility capacity correlation = -0.069"</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"ML and facility capacity correlation = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">er_df</span><span class="op">$</span><span class="va">ML</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">er_df</span><span class="op">$</span><span class="va">ML</span><span class="op">)</span><span class="op">]</span>, <span class="va">rep_date</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">er_df</span><span class="op">$</span><span class="va">ML</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] "ML and facility capacity correlation = -0.044"</span></code></pre></div>
<p>Finally, we create figures and tables for all factors available.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"> <span class="co"># Make a tibble with the loaded factor data, but also outbreak reported date and facility capacity.</span>
<span class="va">cor_data</span> <span class="op">&lt;-</span> <span class="fu">as_tibble</span><span class="op">(</span><span class="va">BC_OSABC_facilitydata</span><span class="op">)</span>
<span class="va">cor_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">cor_data</span>, <span class="va">fac_cap</span>, <span class="va">rep_date</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">cor_data</span><span class="op">)</span><span class="op">[</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">cor_data</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">cor_data</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Facility capacity"</span>, <span class="st">"COVID-19 outbreak reported date"</span><span class="op">)</span>

<span class="co"># Create correlation table, for numeric covariates</span>
<span class="va">rho_table</span> <span class="op">&lt;-</span> <span class="va">cor_data</span> <span class="op">%&gt;%</span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="st">"Number of disease outbreaks 2018/19"</span>,<span class="st">"Number of lodged complaints 2018/19"</span>,
         <span class="st">"Residents dependent for daily activities (%)"</span>,<span class="st">"Average resident stay (days)"</span>,
         <span class="st">"Average resident age (years)"</span>,<span class="st">"Direct care hours /resident/day"</span>,
         <span class="st">"Facility capacity"</span>, <span class="st">"COVID-19 outbreak reported date"</span>, <span class="st">"Year facility opened"</span><span class="op">)</span>
<span class="va">rho_table</span> <span class="op">&lt;-</span>
  <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map2.html">map2_df</a></span><span class="op">(</span><span class="va">rho_table</span>,<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">rho_table</span><span class="op">)</span>,<span class="kw">function</span><span class="op">(</span><span class="va">x</span>,<span class="va">var_name</span><span class="op">)</span><span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html">cor.test</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">BHM</span><span class="op">)</span> <span class="op">%&gt;%</span>
      <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
      <span class="fu">mutate</span><span class="op">(</span>Property <span class="op">=</span> <span class="va">var_name</span><span class="op">)</span>
  <span class="op">}</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">Property</span>,<span class="fu">everything</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="co"># BHM correlations</span>
<span class="va">rho_table</span> <span class="op">%&gt;%</span>
  <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span><span class="op">(</span>bootstrap_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"striped"</span>,<span class="st">"responsive"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<table class="table table table-striped table-responsive">
<thead><tr>
<th style="text-align:left;">
Property
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
statistic
</th>
<th style="text-align:right;">
p.value
</th>
<th style="text-align:right;">
parameter
</th>
<th style="text-align:right;">
conf.low
</th>
<th style="text-align:right;">
conf.high
</th>
<th style="text-align:left;">
method
</th>
<th style="text-align:left;">
alternative
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Number of disease outbreaks 2018/19
</td>
<td style="text-align:right;">
-0.2270282
</td>
<td style="text-align:right;">
-0.8405090
</td>
<td style="text-align:right;">
0.4158149
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
-0.6622703
</td>
<td style="text-align:right;">
0.3227725
</td>
<td style="text-align:left;">
Pearson’s product-moment correlation
</td>
<td style="text-align:left;">
two.sided
</td>
</tr>
<tr>
<td style="text-align:left;">
Number of lodged complaints 2018/19
</td>
<td style="text-align:right;">
-0.5396202
</td>
<td style="text-align:right;">
-2.3109734
</td>
<td style="text-align:right;">
0.0378793
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
-0.8240837
</td>
<td style="text-align:right;">
-0.0378087
</td>
<td style="text-align:left;">
Pearson’s product-moment correlation
</td>
<td style="text-align:left;">
two.sided
</td>
</tr>
<tr>
<td style="text-align:left;">
Residents dependent for daily activities (%)
</td>
<td style="text-align:right;">
0.1531161
</td>
<td style="text-align:right;">
0.5586554
</td>
<td style="text-align:right;">
0.5858915
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
-0.3897143
</td>
<td style="text-align:right;">
0.6169853
</td>
<td style="text-align:left;">
Pearson’s product-moment correlation
</td>
<td style="text-align:left;">
two.sided
</td>
</tr>
<tr>
<td style="text-align:left;">
Average resident stay (days)
</td>
<td style="text-align:right;">
0.3763166
</td>
<td style="text-align:right;">
1.4644810
</td>
<td style="text-align:right;">
0.1668234
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
-0.1684115
</td>
<td style="text-align:right;">
0.7449694
</td>
<td style="text-align:left;">
Pearson’s product-moment correlation
</td>
<td style="text-align:left;">
two.sided
</td>
</tr>
<tr>
<td style="text-align:left;">
Average resident age (years)
</td>
<td style="text-align:right;">
0.0137734
</td>
<td style="text-align:right;">
0.0496656
</td>
<td style="text-align:right;">
0.9611438
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
-0.5020315
</td>
<td style="text-align:right;">
0.5223508
</td>
<td style="text-align:left;">
Pearson’s product-moment correlation
</td>
<td style="text-align:left;">
two.sided
</td>
</tr>
<tr>
<td style="text-align:left;">
Direct care hours /resident/day
</td>
<td style="text-align:right;">
0.3959211
</td>
<td style="text-align:right;">
1.5545441
</td>
<td style="text-align:right;">
0.1440545
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
-0.1459408
</td>
<td style="text-align:right;">
0.7550483
</td>
<td style="text-align:left;">
Pearson’s product-moment correlation
</td>
<td style="text-align:left;">
two.sided
</td>
</tr>
<tr>
<td style="text-align:left;">
Facility capacity
</td>
<td style="text-align:right;">
-0.1668244
</td>
<td style="text-align:right;">
-0.6767814
</td>
<td style="text-align:right;">
0.5082118
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
-0.5879053
</td>
<td style="text-align:right;">
0.3253887
</td>
<td style="text-align:left;">
Pearson’s product-moment correlation
</td>
<td style="text-align:left;">
two.sided
</td>
</tr>
<tr>
<td style="text-align:left;">
COVID-19 outbreak reported date
</td>
<td style="text-align:right;">
-0.2543562
</td>
<td style="text-align:right;">
-1.0520253
</td>
<td style="text-align:right;">
0.3084179
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
-0.6446708
</td>
<td style="text-align:right;">
0.2411508
</td>
<td style="text-align:left;">
Pearson’s product-moment correlation
</td>
<td style="text-align:left;">
two.sided
</td>
</tr>
<tr>
<td style="text-align:left;">
Year facility opened
</td>
<td style="text-align:right;">
-0.1650633
</td>
<td style="text-align:right;">
-0.5797485
</td>
<td style="text-align:right;">
0.5728084
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
-0.6396250
</td>
<td style="text-align:right;">
0.4006005
</td>
<td style="text-align:left;">
Pearson’s product-moment correlation
</td>
<td style="text-align:left;">
two.sided
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R">

<span class="co"># And correlations for dichotomous categorical factors (point-biserial)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"BHM and identity of initial case (is staff) correlation = "</span>, <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/class.html">unclass</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">cor_data</span><span class="op">$</span><span class="st">"Identity of initial COVID-19 case"</span><span class="op">[</span><span class="va">cor_data</span><span class="op">$</span><span class="st">"Identity of initial COVID-19 case"</span><span class="op">!=</span><span class="st">"Unknown"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>, <span class="va">BHM</span><span class="op">[</span><span class="va">cor_data</span><span class="op">$</span><span class="st">"Identity of initial COVID-19 case"</span><span class="op">!=</span><span class="st">"Unknown"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] "BHM and identity of initial case (is staff) correlation = 0.152020983211341"</span>
<span class="co"># Make this one negative since 'not accredited' is associated with a higher number: </span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"BHM and (positive) accreditation status correlation = "</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/class.html">unclass</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">cor_data</span><span class="op">$</span><span class="st">"Accreditation status"</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">cor_data</span><span class="op">$</span><span class="st">"Accreditation status"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>, <span class="va">BHM</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">cor_data</span><span class="op">$</span><span class="st">"Accreditation status"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] "BHM and (positive) accreditation status correlation = 0.272308889310071"</span>



<span class="co">## Plot correlations with R0</span>

<span class="co"># separate numeric and character factors into 2 plots</span>
<span class="va">cols_to_plot_num</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">6</span>, <span class="fl">7</span>, <span class="fl">8</span>, <span class="fl">9</span>, <span class="fl">10</span>, <span class="fl">11</span>, <span class="fl">14</span>, <span class="fl">15</span><span class="op">)</span>
<span class="va">cols_to_plot_cat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">12</span><span class="op">)</span>
<span class="va">cor_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">cor_data</span>, <span class="va">BHM</span><span class="op">)</span>

<span class="va">cordatalong_num</span> <span class="op">&lt;-</span> <span class="fu">pivot_longer</span><span class="op">(</span><span class="va">cor_data</span>, cols <span class="op">=</span> <span class="fu">all_of</span><span class="op">(</span><span class="va">cols_to_plot_num</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"Factor"</span>, values_to <span class="op">=</span> <span class="st">"Value"</span><span class="op">)</span>
<span class="va">cordatalong_cat</span> <span class="op">&lt;-</span> <span class="fu">pivot_longer</span><span class="op">(</span><span class="va">cor_data</span>, cols <span class="op">=</span> <span class="fu">all_of</span><span class="op">(</span><span class="va">cols_to_plot_cat</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"Factor"</span>, values_to <span class="op">=</span> <span class="st">"Value"</span><span class="op">)</span>

<span class="co"># (modified a few aesthetics of figure manually for paper - removed second R_0,k label, rearranged some titles that were cut off)</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data<span class="op">=</span><span class="va">cordatalong_num</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">Value</span>, y <span class="op">=</span> <span class="va">BHM</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span>size<span class="op">=</span><span class="fl">2</span>, colour <span class="op">=</span> <span class="st">"#E84646"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">Factor</span>,  scales <span class="op">=</span> <span class="st">"free"</span>, ncol<span class="op">=</span><span class="fl">4</span><span class="op">)</span> <span class="op">+</span> <span class="fu">xlab</span><span class="op">(</span><span class="st">""</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ylab</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">R</span><span class="op">[</span><span class="st">'0,k'</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>text <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size<span class="op">=</span><span class="fl">12</span><span class="op">)</span>, axis.title.y <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">15</span><span class="op">)</span><span class="op">)</span>

<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data<span class="op">=</span><span class="va">cordatalong_cat</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">Value</span>, y <span class="op">=</span> <span class="va">BHM</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span>size<span class="op">=</span><span class="fl">2</span>, colour <span class="op">=</span> <span class="st">"#E84646"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">Factor</span>,  scales <span class="op">=</span> <span class="st">"free"</span>, ncol<span class="op">=</span><span class="fl">4</span><span class="op">)</span> <span class="op">+</span> <span class="fu">xlab</span><span class="op">(</span><span class="st">""</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ylab</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">R</span><span class="op">[</span><span class="st">'0,k'</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>text <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size<span class="op">=</span><span class="fl">12</span><span class="op">)</span>, axis.title.y <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">15</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="fu">grid.arrange</span><span class="op">(</span>grobs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">p2</span>, <span class="va">p1</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span>, heights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1.1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Warning: Removed 22 rows containing missing values (geom_point).</span></code></pre></div>
<p><img src="BC_LTHC_additional_analysis_files/figure-html/unnamed-chunk-11-1.png" width="960"></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># If using paper colour scheme, reset the colour theme:</span>
<span class="co">#ggthemr_reset()</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Mike Irvine, Sean C. Anderson, Jessica E. Stockdale.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
